<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Warrior V3</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { warteg: '#d97706', water: '#3b82f6' },
                    animation: { 'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite' }
                }
            }
        }
    </script>
    <style>
        body { background-color: #0f172a; font-family: system-ui, -apple-system, sans-serif; color: #f8fafc; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .card-light { background: #ffffff; color: #1e293b; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;

        // --- ICONS ---
        const IconPencil = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"/><path d="m15 5 4 4"/></svg>;
        const IconCheck = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="20 6 9 17 4 12"/></svg>;
        const IconClose = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>;
        const IconFire = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.7 2.45 2.55 3.3 2.9 3.8Z"/></svg>;
        const IconWater = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z"/><path d="M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97"/></svg>;
        const IconPlus = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/><path d="M12 5v14"/></svg>;
        const IconMinus = ({ className }) => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M5 12h14"/></svg>;

        // --- INDONESIAN FOOD INTELLIGENCE ENGINE ---
        const analyzeMeal = (text) => {
            if (!text) return { score: 0, label: 'KOSONG', color: 'bg-gray-200', textCol: 'text-gray-400' };
            const lower = text.toLowerCase();
            let score = 0;
            
            // 1. KARBO (10-20 Pts)
            const carbs = ['nasi', 'mie', 'bihun', 'kwetiau', 'lontong', 'ketupat', 'kentang'];
            if (carbs.some(k => lower.includes(k))) score += 10;
            if (lower.includes('1.5') || lower.includes('jumbo') || lower.includes('tambah') || lower.includes('banyak')) score += 10;
            
            // 2. PROTEIN SULTAN (Heavy Hitters) - 35 Pts
            // Mencakup semua jenis daging, ikan spesifik, seafood, dan jeroan berat
            const heavyProtein = [
                'ayam', 'sapi', 'daging', 'rendang', 'kambing', 'bebek', // Darat
                'ikan', 'lele', 'tongkol', 'bawal', 'kembung', 'nila', 'mas', 'gurame', 'patin', 'bandeng', 'cakalang', 'teri', // Laut/Tawar
                'cumi', 'udang', 'kerang', 'kepiting', 'seafood', // Seafood
                'paru', 'dendeng', 'empal', 'gepuk', 'babat', 'iso', 'tunjang', 'rawon', 'soto' // Olahan Berat
            ];
            if (heavyProtein.some(k => lower.includes(k))) score += 35;
            
            // 3. PROTEIN PENDAMPING (Eggs & Offal) - 20 Pts
            const medProtein = [
                'telur', 'telor', 'puyuh', // Telur
                'ati', 'ampela', 'usus', 'kulit', 'kikil', 'ceker' // Jeroan Ringan/Kulit
            ];
            if (medProtein.some(k => lower.includes(k))) score += 20;

            // 4. LAUK RAKYAT (Nabati & Gorengan) - 15 Pts
            const sideProtein = [
                'tempe', 'tahu', 'oncom', // Nabati
                'perkedel', 'bakwan', 'bala', 'mendoan', 'jagung', 'gorengan' // Gorengan Warteg
            ];
            if (sideProtein.some(k => lower.includes(k))) score += 15;
            
            // 5. BOOSTER KALORI (Sayur & Kuah) - 10 Pts
            const veggies = [
                'sayur', 'sop', 'bayam', 'kangkung', 'sawi', 'buncis', 'kacang', 'daun', 'singkong', 
                'pepaya', 'nangka', 'gudeg', 'urap', 'capcay', 'oseng', 'tumis', 'labu', 'terong', 'pare', 
                'asem', 'lodeh'
            ];
            if (veggies.some(k => lower.includes(k))) score += 10;

            const fats = ['gulai', 'santan', 'kuah', 'kare', 'bumbu', 'rica', 'balado', 'sate', 'semur'];
            if (fats.some(k => lower.includes(k))) score += 10; // Extra calories from fat/sauce

            // CALCULATE GRADE
            let result = { score, grade: 'C', label: 'WEAK', color: 'bg-red-500', textCol: 'text-red-600', width: '25%' };
            
            if (score >= 85) result = { score, grade: 'S', label: 'WARTEG KING', color: 'bg-purple-600', textCol: 'text-purple-500', width: '100%', animate: true };
            else if (score >= 65) result = { score, grade: 'A', label: 'GIGA BULK', color: 'bg-green-600', textCol: 'text-green-600', width: '80%' };
            else if (score >= 45) result = { score, grade: 'B', label: 'DECENT', color: 'bg-yellow-500', textCol: 'text-yellow-600', width: '55%' };
            
            return result;
        };

        const MealScore = ({ text }) => {
            const analysis = analyzeMeal(text);
            return (
                <div className="mt-2">
                    <div className="flex justify-between items-end mb-1">
                        <span className={`text-[10px] font-black uppercase tracking-wider ${analysis.textCol} flex items-center gap-1`}>
                            {analysis.grade === 'S' && <IconFire className="w-3 h-3 animate-bounce" />} {analysis.label}
                        </span>
                        <span className="text-[9px] text-gray-400 font-bold">{analysis.score} PTS</span>
                    </div>
                    <div className="w-full bg-gray-100 rounded-full h-1.5 overflow-hidden"><div className={`h-full rounded-full transition-all duration-700 ease-out ${analysis.color} ${analysis.animate ? 'animate-pulse' : ''}`} style={{ width: analysis.width }}></div></div>
                </div>
            )
        };

        // --- CHART COMPONENT ---
        const WeightChart = ({ history, target }) => {
            if (!history || history.length < 2) return <div className="text-center p-4 text-sm text-gray-400">Butuh minimal 2 data berat badan untuk menampilkan grafik.</div>;

            const width = 300; const height = 150; const padding = 20;
            const weights = history.map(h => h.w);
            const minW = Math.min(...weights, target) - 1;
            const maxW = Math.max(...weights, target) + 1;
            
            const getX = (i) => padding + (i / (history.length - 1)) * (width - padding * 2);
            const getY = (w) => height - padding - ((w - minW) / (maxW - minW)) * (height - padding * 2);

            const points = history.map((h, i) => `${getX(i)},${getY(h.w)}`).join(' ');
            const targetY = getY(target);

            return (
                <div className="flex flex-col items-center">
                    <svg width="100%" viewBox={`0 0 ${width} ${height}`} className="overflow-visible">
                        <line x1={padding} y1={targetY} x2={width-padding} y2={targetY} stroke="#10b981" strokeWidth="1" strokeDasharray="4 4" opacity="0.5" />
                        <text x={width-padding+5} y={targetY+3} className="text-[8px] fill-green-500 font-bold">Target</text>
                        <polyline points={points} fill="none" stroke="#f97316" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" />
                        {history.map((h, i) => (
                            <g key={i}>
                                <circle cx={getX(i)} cy={getY(h.w)} r="4" fill="#fff" stroke="#f97316" strokeWidth="2" />
                                <text x={getX(i)} y={getY(h.w) - 10} textAnchor="middle" className="text-[10px] fill-gray-500 font-bold">{h.w}</text>
                                <text x={getX(i)} y={height} textAnchor="middle" className="text-[8px] fill-gray-400">{h.d.split(' ')[0]}</text>
                            </g>
                        ))}
                    </svg>
                </div>
            );
        };

        // --- WATER COMPONENT ---
        const WaterTracker = ({ count, onAdd, onRemove }) => {
            const target = 8;
            return (
                <div className="bg-gradient-to-r from-blue-600 to-blue-500 rounded-2xl p-4 shadow-lg flex items-center justify-between mb-6 relative overflow-hidden text-white border border-blue-400/30">
                    <div className="flex items-center gap-3 z-10">
                        <div className="bg-white/20 p-2 rounded-full backdrop-blur-sm">
                            <IconWater className="w-6 h-6 text-white" />
                        </div>
                        <div>
                            <div className="text-[10px] font-bold text-blue-100 uppercase tracking-wide opacity-80">Hidrasi</div>
                            <div className="text-2xl font-black leading-none">{count}<span className="text-sm font-medium opacity-70">/{target}</span></div>
                        </div>
                    </div>
                    <div className="flex items-center gap-2 z-10">
                        <button onClick={onRemove} className="w-8 h-8 rounded-full bg-black/20 text-white flex items-center justify-center hover:bg-black/30 active:scale-95 transition-all"><IconMinus className="w-4 h-4"/></button>
                        <button onClick={onAdd} className="w-10 h-10 rounded-full bg-white text-blue-600 shadow-xl flex items-center justify-center hover:scale-105 active:scale-90 transition-all"><IconPlus className="w-5 h-5 stroke-[3px]"/></button>
                    </div>
                </div>
            );
        };

        // --- EDIT MENU MODAL (LIVE SCORE) ---
        const EditMenuModal = ({ isOpen, item, onClose, onSave }) => {
            const [lunch, setLunch] = useState('');
            const [dinner, setDinner] = useState('');

            useEffect(() => {
                if(item) { setLunch(item.lunch); setDinner(item.dinner); }
            }, [item]);

            if(!isOpen) return null;

            return (
                <div className="fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 backdrop-blur-sm animate-[fadeIn_0.2s]">
                    <div className="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl relative text-slate-800">
                        <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 hover:text-red-500"><IconClose className="w-6 h-6"/></button>
                        <h3 className="text-xl font-black mb-4">EDIT & ANALYZE</h3>
                        
                        <div className="space-y-4">
                            <div>
                                <label className="text-[10px] font-black text-gray-400 uppercase">Makan Siang</label>
                                <textarea 
                                    value={lunch} 
                                    onChange={(e) => setLunch(e.target.value)}
                                    className="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 text-sm font-bold focus:outline-none focus:border-orange-500 mt-1"
                                    rows="3"
                                    placeholder="Contoh: Nasi, Ayam Bakar, Usus, Sayur Asem"
                                />
                                {/* LIVE SCORE PREVIEW */}
                                <MealScore text={lunch} />
                            </div>

                            <div>
                                <label className="text-[10px] font-black text-gray-400 uppercase">Makan Malam</label>
                                <textarea 
                                    value={dinner} 
                                    onChange={(e) => setDinner(e.target.value)}
                                    className="w-full bg-gray-50 border-2 border-gray-100 rounded-xl p-3 text-sm font-bold focus:outline-none focus:border-orange-500 mt-1"
                                    rows="3"
                                    placeholder="Contoh: Nasi, Pecel Lele, Tahu, Lalapan"
                                />
                                {/* LIVE SCORE PREVIEW */}
                                <MealScore text={dinner} />
                            </div>
                        </div>

                        <button onClick={() => onSave(lunch, dinner)} className="w-full bg-black text-white py-4 rounded-xl font-bold mt-6 shadow-lg active:scale-95 transition-all">
                            SIMPAN PERUBAHAN
                        </button>
                    </div>
                </div>
            );
        };

        // --- WEIGHT MODAL ---
        const WeightModal = ({ isOpen, onClose, history, target, onUpdate }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 bg-black/90 z-50 flex items-center justify-center p-4 backdrop-blur-md animate-[fadeIn_0.2s]">
                    <div className="bg-white w-full max-w-sm rounded-3xl p-6 shadow-2xl relative text-slate-800">
                        <button onClick={onClose} className="absolute top-4 right-4 text-gray-400 hover:text-red-500"><IconClose className="w-6 h-6"/></button>
                        <h3 className="text-xl font-black mb-1">PROGRESS</h3>
                        <p className="text-xs text-gray-500 mb-6 font-bold uppercase tracking-wide">Track Your Gains</p>
                        <div className="mb-8 bg-gray-50 rounded-xl p-2 border border-gray-100">
                            <WeightChart history={history} target={target} />
                        </div>
                        <button onClick={onUpdate} className="w-full bg-orange-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-orange-500/30 active:scale-95 transition-all">UPDATE BERAT</button>
                    </div>
                </div>
            );
        }

        // --- APP LOGIC ---
        function App() {
            const [user, setUser] = useState(null);
            const [plan, setPlan] = useState([]);
            const [waterLog, setWaterLog] = useState({});
            
            // Modal States
            const [weightModalOpen, setWeightModalOpen] = useState(false);
            const [editMenuOpen, setEditMenuOpen] = useState(false);
            const [editingIndex, setEditingIndex] = useState(null);

            const todayRef = useRef(null);

            const MENUS = [
                {l: 'Nasi + Ayam Goreng + Telur Dadar + Sop', d: 'Nasi + Ikan Tongkol + Perkedel + Kangkung'},
                {l: 'Nasi + Lele (2) + Tahu Bacem + Lalapan', d: 'Nasi + Telur Balado + Orek Tempe + Sayur Asem'},
                {l: 'Nasi + Rendang + Daun Singkong + Gulai', d: 'Nasi + Ayam Bakar + Tempe Mendoan + Capcay'},
                {l: 'Nasi (1.5) + Opor Ayam + Telur Ceplok', d: 'Nasi + Ati Ampela + Tahu Kuning + Lodeh'}
            ];

            useEffect(() => {
                const u = localStorage.getItem('bulk_warrior_user');
                const p = localStorage.getItem('bulk_warrior_plan');
                const w = localStorage.getItem('bulk_warrior_water');
                if (u && p) { setUser(JSON.parse(u)); setPlan(JSON.parse(p)); if(w) setWaterLog(JSON.parse(w)); }
            }, []);

            useEffect(() => {
                if (user) {
                    localStorage.setItem('bulk_warrior_user', JSON.stringify(user));
                    localStorage.setItem('bulk_warrior_plan', JSON.stringify(plan));
                    localStorage.setItem('bulk_warrior_water', JSON.stringify(waterLog));
                }
            }, [user, plan, waterLog]);

            useEffect(() => {
                if (todayRef.current) setTimeout(() => todayRef.current.scrollIntoView({ behavior: 'smooth', block: 'center' }), 600);
            }, [user]);

            const generatePlan = (data) => {
                const s = new Date(data.start), e = new Date(data.end);
                const days = Math.ceil(Math.abs(e - s) / 86400000);
                let newPlan = [];
                for(let i=0; i<=days; i++){
                    let d = new Date(s); d.setDate(s.getDate()+i);
                    newPlan.push({
                        date: d.toLocaleDateString('id-ID', {day:'numeric', month:'short'}),
                        day: d.toLocaleDateString('id-ID', {weekday:'long'}),
                        fullDate: d.toDateString(),
                        lunch: MENUS[i%MENUS.length].l, dinner: MENUS[i%MENUS.length].d,
                        lChk: false, dChk: false
                    });
                }
                const firstLog = { d: new Date().toLocaleDateString('id-ID', {day:'numeric', month:'short'}), w: data.weight };
                setUser({ ...data, history: [firstLog] });
                setPlan(newPlan);
            };

            const toggleMeal = (idx, type) => {
                const n = [...plan];
                if(type==='l') n[idx].lChk = !n[idx].lChk; else n[idx].dChk = !n[idx].dChk;
                setPlan(n);
            };

            const openEdit = (index) => {
                setEditingIndex(index);
                setEditMenuOpen(true);
            };

            const saveMenuEdit = (newL, newD) => {
                const newPlan = [...plan];
                newPlan[editingIndex].lunch = newL;
                newPlan[editingIndex].dinner = newD;
                setPlan(newPlan);
                setEditMenuOpen(false);
            };

            const getTodayKey = () => new Date().toDateString();
            const updateWater = (amount) => {
                const key = getTodayKey();
                const current = waterLog[key] || 0;
                setWaterLog({ ...waterLog, [key]: Math.max(0, current + amount) });
            };

            const updateWeight = () => {
                const w = prompt("Berat badan sekarang (kg):", user.weight);
                if(w && !isNaN(w)) {
                    const todayStr = new Date().toLocaleDateString('id-ID', {day:'numeric', month:'short'});
                    const newHistory = [...user.history, { d: todayStr, w: parseFloat(w) }];
                    setUser({ ...user, weight: parseFloat(w), history: newHistory });
                }
            };

            if (!user) return <div className="min-h-screen flex items-center justify-center p-6 bg-slate-900">
                <form onSubmit={(e) => {
                    e.preventDefault();
                    const fd = new FormData(e.target);
                    const d = Object.fromEntries(fd);
                    if(!d.name || !d.start || !d.end) return alert("Lengkapi data!");
                    if(new Date(d.end) <= new Date(d.start)) return alert("Tanggal ngaco!");
                    generatePlan({ name: d.name, weight: parseFloat(d.weight), target: parseFloat(d.target), start: d.start, end: d.end });
                }} className="w-full max-w-sm bg-white text-gray-900 p-8 rounded-3xl shadow-2xl relative overflow-hidden">
                    <div className="absolute top-0 left-0 w-full h-2 bg-orange-600"></div>
                    <h1 className="text-3xl font-black text-slate-800 text-center mb-1">BULK WARRIOR</h1>
                    <p className="text-center text-gray-400 text-xs font-bold uppercase tracking-widest mb-8">Setup Your Journey</p>
                    <div className="space-y-4">
                        <input name="name" placeholder="Nama Panggilan" className="w-full border-2 border-gray-100 p-3 rounded-xl font-bold bg-gray-50 focus:outline-none focus:border-orange-500" required />
                        <div className="grid grid-cols-2 gap-3">
                            <input name="weight" type="number" placeholder="Berat Awal" className="border-2 border-gray-100 p-3 rounded-xl font-bold bg-gray-50 focus:outline-none focus:border-orange-500" required />
                            <input name="target" type="number" placeholder="Target" className="border-2 border-gray-100 p-3 rounded-xl font-bold bg-gray-50 focus:outline-none focus:border-orange-500" required />
                        </div>
                        <div className="bg-gray-50 p-3 rounded-xl border-2 border-gray-100">
                            <div className="text-[10px] text-gray-400 uppercase font-bold mb-2">Durasi Bulking</div>
                            <div className="grid grid-cols-2 gap-3">
                                <input name="start" type="date" className="bg-white border p-2 rounded-lg text-xs font-bold outline-none" required />
                                <input name="end" type="date" className="bg-white border p-2 rounded-lg text-xs font-bold outline-none" required />
                            </div>
                        </div>
                        <button className="w-full bg-orange-600 text-white py-4 rounded-xl font-bold mt-2 shadow-lg shadow-orange-500/30 hover:translate-y-[-2px] transition-all">MULAI!</button>
                    </div>
                </form>
            </div>;

            const isToday = (d) => new Date(d).toDateString() === new Date().toDateString();

            return (
                <div className="max-w-md mx-auto bg-slate-50 min-h-screen pb-20 relative text-slate-800">
                    {/* HEADER */}
                    <div className="bg-slate-900 text-white p-6 pb-16 rounded-b-[2.5rem] shadow-2xl sticky top-0 z-20">
                        <div className="flex justify-between items-center">
                            <div>
                                <h2 className="font-black text-2xl italic tracking-tighter">BULK WARRIOR</h2>
                                <div className="text-[10px] text-orange-500 uppercase tracking-widest font-bold">Project: {user.name}</div>
                            </div>
                            <button onClick={() => setWeightModalOpen(true)} className="glass px-4 py-2 rounded-xl text-sm font-bold flex items-center gap-2 active:scale-95 transition-all hover:bg-white/10">
                                <span>{user.weight} kg</span>
                                <div className="bg-green-500 w-2 h-2 rounded-full animate-pulse"></div>
                            </button>
                        </div>
                    </div>

                    {/* CONTENT OVERLAP */}
                    <div className="px-5 -mt-10 relative z-30">
                        
                        {/* WATER TRACKER WIDGET */}
                        <WaterTracker 
                            count={waterLog[getTodayKey()] || 0} 
                            onAdd={() => updateWater(1)} 
                            onRemove={() => updateWater(-1)} 
                        />

                        {/* LIST JADWAL */}
                        <div className="space-y-5">
                            {plan.map((item, idx) => {
                                const active = isToday(item.fullDate);
                                return (
                                    <div key={idx} ref={active?todayRef:null} className={`card-light p-5 rounded-3xl border transition-all relative ${active ? 'border-orange-500 shadow-xl shadow-orange-500/10 ring-4 ring-orange-500/10 scale-[1.02] z-10' : 'border-gray-100 shadow-sm opacity-90'}`}>
                                        <div className="flex justify-between items-center mb-4 border-b border-dashed pb-3 border-gray-100">
                                            <div>
                                                <div className={`font-black text-xl ${active?'text-orange-600':'text-slate-800'}`}>{item.date}</div>
                                                <div className="text-[10px] font-bold text-gray-400 uppercase tracking-wide">{item.day}</div>
                                            </div>
                                            
                                            {/* EDIT BUTTON (DITAMBAHKAN DI SINI) */}
                                            <div className="flex items-center gap-2">
                                                {active && <span className="bg-orange-600 text-white px-3 py-1 rounded-full text-[10px] font-bold shadow-lg shadow-orange-500/40">HARI INI</span>}
                                                <button onClick={() => openEdit(idx)} className="p-2 rounded-full hover:bg-gray-100 text-gray-400 hover:text-orange-500 transition-colors">
                                                    <IconPencil className="w-4 h-4" />
                                                </button>
                                            </div>
                                        </div>

                                        <div className="space-y-4">
                                            {/* Lunch */}
                                            <div onClick={()=>toggleMeal(idx, 'l')} className="cursor-pointer group">
                                                <div className="flex items-start gap-3">
                                                    <div className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center mt-0.5 transition-all ${item.lChk?'bg-green-500 border-green-500 scale-110':'border-gray-200 group-hover:border-orange-300'}`}>
                                                        {item.lChk && <IconCheck className="w-4 h-4 text-white stroke-[3px]"/>}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="text-[9px] font-black text-gray-300 uppercase mb-0.5">MAKAN SIANG</div>
                                                        <div className={`text-sm font-bold leading-snug transition-all ${item.lChk?'line-through text-gray-300':'text-slate-700'}`}>{item.lunch}</div>
                                                        {!item.lChk && <MealScore text={item.lunch} />}
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            {/* Dinner */}
                                            <div onClick={()=>toggleMeal(idx, 'd')} className="cursor-pointer group">
                                                <div className="flex items-start gap-3">
                                                    <div className={`w-6 h-6 rounded-lg border-2 flex items-center justify-center mt-0.5 transition-all ${item.dChk?'bg-green-500 border-green-500 scale-110':'border-gray-200 group-hover:border-orange-300'}`}>
                                                        {item.dChk && <IconCheck className="w-4 h-4 text-white stroke-[3px]"/>}
                                                    </div>
                                                    <div className="flex-1">
                                                        <div className="text-[9px] font-black text-gray-300 uppercase mb-0.5">MALAM</div>
                                                        <div className={`text-sm font-bold leading-snug transition-all ${item.dChk?'line-through text-gray-300':'text-slate-700'}`}>{item.dinner}</div>
                                                        {!item.dChk && <MealScore text={item.dinner} />}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )
                            })}
                        </div>
                    </div>

                    <div className="text-center mt-12 pb-8">
                        <button onClick={()=>{if(confirm('Yakin mau reset? Semua data akan hilang!')) {localStorage.clear(); window.location.reload()}}} className="text-xs font-bold text-gray-400 hover:text-red-600 transition-colors uppercase tracking-widest">Reset All Data</button>
                    </div>

                    <WeightModal isOpen={weightModalOpen} onClose={() => setWeightModalOpen(false)} history={user.history} target={user.target} onUpdate={updateWeight} />
                    
                    {/* EDIT MENU MODAL DITAMBAHKAN */}
                    <EditMenuModal 
                        isOpen={editMenuOpen} 
                        item={editingIndex !== null ? plan[editingIndex] : null} 
                        onClose={() => setEditMenuOpen(false)} 
                        onSave={saveMenuEdit} 
                    />
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

